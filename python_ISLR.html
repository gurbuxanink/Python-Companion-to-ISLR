<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2019-05-19 Sun 15:26 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>A Python Companion to ISLR</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Naresh Gurbuxani" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">A Python Companion to ISLR</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orga509047">1. Introduction</a></li>
<li><a href="#orgb55b091">2. Statistical Learning</a>
<ul>
<li><a href="#orgae8e067">2.1. What is Statistical Learning?</a></li>
<li><a href="#org2775be8">2.2. Assessing Model Accuracy</a></li>
<li><a href="#orgaa5eab1">2.3. Lab: Introduction to Python</a>
<ul>
<li><a href="#orga734d08">2.3.1. Basic Commands</a></li>
<li><a href="#org919154a">2.3.2. Graphics</a></li>
<li><a href="#org9cc2243">2.3.3. Indexing Data</a></li>
<li><a href="#org9a3f71c">2.3.4. Loading Data</a></li>
<li><a href="#org67608e2">2.3.5. Additional Graphical and Numerical Summaries</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org47b72b3">3. Linear Regression</a>
<ul>
<li><a href="#orgd189fed">3.1. Simple Linear Regression</a></li>
<li><a href="#org388f5f8">3.2. Multiple Linear Regression</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orga509047" class="outline-2">
<h2 id="orga509047"><span class="section-number-2">1</span> Introduction</h2>
<div class="outline-text-2" id="text-1">
<p>
Figure <a href="#orga2d2a1f">1</a> shows graphs of Wage versus three variables. 
</p>


<div id="orga2d2a1f" class="figure">
<p><img src="figures/fig1_1.png" alt="fig1_1.png" />
</p>
<p><span class="figure-number">Figure 1: </span><code>Wage</code> data, which contains income survey information for males from the central Atlantic region of the United States.  Left: <code>wage</code> as a function of <code>age</code>.  On average, <code>wage</code> increases with <code>age</code> until about 60 years of age, at which point it begins to decline.  Center: <code>wage</code> as a function of <code>year</code>.  There is a slow but steady increase of approximately $10,000 in the average <code>wage</code> between 2003 and 2009.  Right: Boxplots displaying <code>wage</code> as a function of <code>education</code>, with 1 indicating the lowest level (no highschool diploma) and 5 the highest level (an advanced graduate degree).  On average, <code>wage</code> increases with the level of <code>education</code>.</p>
</div>


<p>
Figure <a href="#org2863b53">2</a> shows boxplots of previous days' percentage changes in S&amp;P
500 grouped according to today's change <code>Up</code> or <code>Down</code>. 
</p>


<div id="org2863b53" class="figure">
<p><img src="figures/fig1_2.png" alt="fig1_2.png" />
</p>
<p><span class="figure-number">Figure 2: </span>Left: Boxplots of the previous day's percentage change in the S&amp;P 500 index for the days for which the market increased or decreased, obtained from the <code>Smarket</code> data.  Center and Right: Same as left panel, but the percentage changes for two and three days previous are shown.</p>
</div>
</div>
</div>

<div id="outline-container-orgb55b091" class="outline-2">
<h2 id="orgb55b091"><span class="section-number-2">2</span> Statistical Learning</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-orgae8e067" class="outline-3">
<h3 id="orgae8e067"><span class="section-number-3">2.1</span> What is Statistical Learning?</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Figure <a href="#orgc575e68">3</a> shows scatter plots of <code>sales</code> versus <code>TV</code>, <code>radio</code>,
and <code>newspaper</code> advertising.  In each panel, the figure also includes an OLS
regression line.  
</p>


<div id="orgc575e68" class="figure">
<p><img src="figures/fig2_1.png" alt="fig2_1.png" />
</p>
<p><span class="figure-number">Figure 3: </span>The <code>Advertising</code> data set. The plot displays <code>sales</code>, in thousands of units, as a function of <code>TV</code>, <code>radio</code>, and <code>newspaper</code> budgets, in thousands of dollars, for 200 different markets.  In each plot we show the simple least squares fit of <code>sales</code> to that variable.  In other words, each red line represents a simple model that can be used to predict <code>sales</code> using <code>TV</code>, <code>radio</code>, and <code>newspaper</code>, respectively.</p>
</div>


<p>
Figure <a href="#org12baa43">4</a> is a plot of <code>Income</code> versus <code>Years of Education</code> from the
Income data set.  In the left panel, the ``true'' function (given by blue line)
is actually my guess.  
</p>


<div id="org12baa43" class="figure">
<p><img src="figures/fig2_2.png" alt="fig2_2.png" />
</p>
<p><span class="figure-number">Figure 4: </span>The <code>Income</code> data set.  Left: The red dots are the observed values of <code>income</code> (in tens of thousands of dollars) and <code>years of education</code> for 30 individuals.  Right: The blue curve represents the true underlying relationship between <code>income</code> and <code>years of education</code>, which is generally unknown (but is known in this case because the data are simulated).  The vertical lines represent the error associated with each observation.  Note that some of the errors are positive (when an observation lies above the blue curve) and some are negative (when an observation lies below the curve).  Overall, these errors have approximately mean zero.</p>
</div>


<p>
Figure <a href="#orge70a3d8">5</a> is a plot of <code>Income</code> versus <code>Years of Education</code> and
<code>Seniority</code> from the <code>Income</code> data set.  Since the book does not provide the
true values of <code>Income</code>, ``true'' values shown in the plot are actually third
order polynomial fit.  
</p>


<div id="orge70a3d8" class="figure">
<p><img src="figures/fig2_3.png" alt="fig2_3.png" />
</p>
<p><span class="figure-number">Figure 5: </span>The plot displays <code>income</code> as a function of <code>years of education</code> and <code>seniority</code> in the <code>Income</code> data set.  The blue surface represents the true underlying relationship between <code>income</code> and <code>years of education</code> and <code>seniority</code>, which is known since the data are simulated.  The red dots indicate the observed values of these quantities for 30 individuals.</p>
</div>


<p>
Figure <a href="#org27e4a88">6</a> shows an example of the parametric approach applied to
the <code>Income</code> data from previous figure. 
</p>


<div id="org27e4a88" class="figure">
<p><img src="figures/fig2_4.png" alt="fig2_4.png" />
</p>
<p><span class="figure-number">Figure 6: </span>A linear model fit by least squares to the <code>Income</code> data from figure <a href="#orge70a3d8">5</a>.  The observations are shown in red, and the blue plane indicates the least squares fit to the data.</p>
</div>


<p>
Figure <a href="#org6d5de89">7</a> provides an illustration of the trade-off between
flexibility and interpretability for some of the methods covered in this book.
</p>


<div id="org6d5de89" class="figure">
<p><img src="figures/figure2_7.png" alt="figure2_7.png" />
</p>
<p><span class="figure-number">Figure 7: </span>A representation of the tradeoff between flexibility and interpretability, using different statistical learning methods.  In general, as the flexibility of a method increases, its interpretability decreases.</p>
</div>


<p>
Figure <a href="#org347de00">8</a> provides a simple illustration of the clustering problem.
</p>


<div id="org347de00" class="figure">
<p><img src="figures/fig2_8.png" alt="fig2_8.png" />
</p>
<p><span class="figure-number">Figure 8: </span>A clustering data set involving three groups.  Each group is shown using a different colored symbol.  Left: The three groups are well-separated.  In this setting, a clustering approach should successfully identify the three groups.  Right: There is some overlap among the groups.  Now the clustering taks is more challenging.</p>
</div>
</div>
</div>

<div id="outline-container-org2775be8" class="outline-3">
<h3 id="org2775be8"><span class="section-number-3">2.2</span> Assessing Model Accuracy</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Figure <a href="#orgbc7db97">9</a> illustrates the tradeoff between training MSE and test
MSE.  We select a ``true function'' whose shape is similar to that shown in the
book.  In the left panel, the orange, blue, and green curves illustrate three possible estimates
for \(f\) given by the black curve.  The orange line is the linear regression
fit, which is relatively inflexible.  The blue and green curves were produced
using <i>smoothing splines</i> from <code>UnivariateSpline</code> function in <code>scipy</code> package.
We obtain different levels of flexibility by varying the parameter <code>s</code>, which
affects the number of knots.  
</p>

<p>
For the right panel, we have chosen polynomial fits.  The degree of polynomial
represents the level of flexibility.  This is because the function
<code>UnivariateSpline</code> does not more than five degrees of freedom.  
</p>

<p>
When we repeat the simulations for figure <a href="#orgbc7db97">9</a>, we see considerable
variation in the right panel MSE plots.  But the overall conclusion remains the
same.   
</p>


<div id="orgbc7db97" class="figure">
<p><img src="figures/fig2_9.png" alt="fig2_9.png" />
</p>
<p><span class="figure-number">Figure 9: </span>Left: Data simulated from \(f\), shown in black.  Three estimates of \(f\) are shown: the linear regression line (orange curve), and two smoothing spline fits (blue and green curves).  Right: Training MSE (grey curve), test MSE (red curve), and minimum possible test MSE over all methods (dashed grey line).</p>
</div>


<p>
Figure <a href="#org57d47bb">10</a> provides another example in which the true \(f\) is
approximately linear. 
</p>


<div id="org57d47bb" class="figure">
<p><img src="figures/fig2_10.png" alt="fig2_10.png" />
</p>
<p><span class="figure-number">Figure 10: </span>Details are as in figure <a href="#orgbc7db97">9</a> using a different true \(f\) that is much closer to linear.  In this setting, linear regression provides a very good fit to the data.</p>
</div>


<p>
Figure <a href="#orgb909169">11</a> displays an example in which \(f\) is highly
non-linear. The training and test MSE curves still exhibit the same general
patterns.
</p>


<div id="orgb909169" class="figure">
<p><img src="figures/fig2_11.png" alt="fig2_11.png" />
</p>
<p><span class="figure-number">Figure 11: </span>Details are as in figure <a href="#orgbc7db97">9</a>, using a different \(f\) that is far from linear.  In this setting, linear regression provides a very poor fit to the data.</p>
</div>


<p>
Figure <a href="#org2691430">12</a> displays the relationship between bias, variance, and
test MSE.  This relationship is referred to as <i>bias-variance trade-off</i>.  When
simulations are repeated, we see considerable variation in different graphs,
especially for MSE lines.  But overall shape remains the same. 
</p>


<div id="org2691430" class="figure">
<p><img src="figures/fig2_12.png" alt="fig2_12.png" />
</p>
<p><span class="figure-number">Figure 12: </span>Squared bias (blue curve), variance (orange curve), \(Var(\epsilon)\) (dashed line), and test MSE (red curve) for the three data sets in figures <a href="#orgbc7db97">9</a> - <a href="#orgb909169">11</a>.  The vertical dotted line indicates the flexibility level corresponding to the smallest test MSE.</p>
</div>


<p>
Figure <a href="#orgffaf054">13</a> provides an example using a simulated data set in
two-dimensional space consisting of predictors \(X_1\) and \(X_2\).  
</p>


<div id="orgffaf054" class="figure">
<p><img src="figures/fig2_13.png" alt="fig2_13.png" />
</p>
<p><span class="figure-number">Figure 13: </span>A simulated data set consisting of 200 observations in two groups, indicated in blue and orange.  The dashed line represents the Bayes decision boundary.  The orange background grid indicates the region in which a test observation will be assigned to the orange class, and blue background grid indicates the region in which a test observation will be assigned to the blue class.</p>
</div>


<p>
Figure <a href="#org0ac27c6">14</a> displays the KNN decision boundary, using \(K=10\), when
applied to the simulated data set from figure <a href="#orgffaf054">13</a>.  Even though
the true distribution is not known by the KNN classifier, the KNN decision
making boundary is very close to that of the Bayes classifier.  
</p>


<div id="org0ac27c6" class="figure">
<p><img src="figures/fig2_15.png" alt="fig2_15.png" />
</p>
<p><span class="figure-number">Figure 14: </span>The firm line indicates the KNN decision boundary on the data from figure <a href="#orgffaf054">13</a>, using \(K = 10\). The Bayes decision boundary is shown as a dashed line.  The KNN and Bayes decision boundaries are very similar.</p>
</div>



<div id="orge7437a0" class="figure">
<p><img src="figures/fig2_16.png" alt="fig2_16.png" />
</p>
<p><span class="figure-number">Figure 15: </span>A comparison of the KNN decision boundaries (solid curves) obtained using \(K=1\) and \(K=100\) on the data from figure <a href="#orgffaf054">13</a>.  With \(K=1\), the decision boundary is overly flexible, while with \(K=100\) it is not sufficiently flexible.  The Bayes decision boundary is shown as dashed line.</p>
</div>


<p>
In figure <a href="#orgc337423">16</a> we have plotted the KNN test and training errors as
a function of \(\frac{1}{K}\).  As \(\frac{1}{K}\) increases, the method becomes
more flexible.  As in the regression setting, the training error rate
consistently declines as the flexibility increases.  However, the test error
exhibits the characteristic U-shape, declining at first (with a minimum at
approximately \(K=10\)) before increasing again when the method becomes
excessively flexible and overfits. 
</p>


<div id="orgc337423" class="figure">
<p><img src="figures/fig2_17.png" alt="fig2_17.png" />
</p>
<p><span class="figure-number">Figure 16: </span>The KNN training error rate (blue, 200 observations) and test error rate (orange, 5,000 observations) on the data from figure <a href="#orgffaf054">13</a> as the level of flexibility (assessed using \(\frac{1}{K}\)) increases, or equivalently as the number of neighbors \(K\) decreases.  The black dashed line indicates the Bayes error rate.</p>
</div>
</div>
</div>

<div id="outline-container-orgaa5eab1" class="outline-3">
<h3 id="orgaa5eab1"><span class="section-number-3">2.3</span> Lab: Introduction to Python</h3>
<div class="outline-text-3" id="text-2-3">
</div>
<div id="outline-container-orga734d08" class="outline-4">
<h4 id="orga734d08"><span class="section-number-4">2.3.1</span> Basic Commands</h4>
<div class="outline-text-4" id="text-2-3-1">
<p>
In <code>Python</code> a list can be created by enclosing comma-separated elements by
square brackets.  Length of a list can be obtained using <code>len</code> function.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #a0522d;">x</span> = [1, 3, 2, 5]
<span style="color: #a020f0;">print</span>(<span style="color: #483d8b;">len</span>(x))
<span style="color: #a0522d;">y</span> = 3
<span style="color: #a0522d;">z</span> = 5
<span style="color: #a020f0;">print</span>(y + z)
</pre>
</div>

<pre class="example">
4
8

</pre>

<p>
To create an array of numbers, use <code>array</code> function in <code>numpy</code> library.  <code>numpy</code>
functions can be used to perform element-wise operations on arrays.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> numpy <span style="color: #a020f0;">as</span> np
<span style="color: #a0522d;">x</span> = np.array([[1, 2], [3, 4]])
<span style="color: #a0522d;">y</span> = np.array([6, 7, 8, 9]).reshape((2, 2))
<span style="color: #a020f0;">print</span>(x)
<span style="color: #a020f0;">print</span>(y)
<span style="color: #a020f0;">print</span>(x ** 2)
<span style="color: #a020f0;">print</span>(np.sqrt(y))
</pre>
</div>

<pre class="example">
[[1 2]
 [3 4]]
[[6 7]
 [8 9]]
[[ 1  4]
 [ 9 16]]
[[2.44948974 2.64575131]
 [2.82842712 3.        ]]

</pre>


<p>
<code>numpy.random</code> has a number of functions to generate random variables that
follow a given distribution.  Here we create two correlated sets of numbers, <code>x</code>
and <code>y</code>, and use <code>numpy.corrcoef</code> to calculate correlation between them. 
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> numpy <span style="color: #a020f0;">as</span> np
np.random.seed(911)
<span style="color: #a0522d;">x</span> = np.random.normal(size=50)
<span style="color: #a0522d;">y</span> = x + np.random.normal(loc=50, scale=0.1, size=50)
<span style="color: #a020f0;">print</span>(np.corrcoef(x, y))
<span style="color: #a020f0;">print</span>(np.corrcoef(x, y)[0, 1])
<span style="color: #a020f0;">print</span>(np.mean(x))
<span style="color: #a020f0;">print</span>(np.var(y))
<span style="color: #a020f0;">print</span>(np.std(y) ** 2)
</pre>
</div>

<pre class="example">
[[1.         0.99374931]
 [0.99374931 1.        ]]
0.9937493134584551
-0.020219724397254404
0.9330621750073689
0.9330621750073688

</pre>
</div>
</div>

<div id="outline-container-org919154a" class="outline-4">
<h4 id="org919154a"><span class="section-number-4">2.3.2</span> Graphics</h4>
<div class="outline-text-4" id="text-2-3-2">
<p>
<code>matplotlib</code> library has a number of functions to plot data in <code>Python</code>.  It is
possible to view graphs on screen or save them in file for inclusion in a
document. 
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> numpy <span style="color: #a020f0;">as</span> np
<span style="color: #a020f0;">import</span> matplotlib               <span style="color: #b22222;"># </span><span style="color: #b22222;">only if we need to save figure in file</span>
matplotlib.use(<span style="color: #8b2252;">'Agg'</span>)           <span style="color: #b22222;"># </span><span style="color: #b22222;">only to save figure in file</span>
<span style="color: #a020f0;">import</span> matplotlib.pyplot <span style="color: #a020f0;">as</span> plt

<span style="color: #a0522d;">x</span> = np.random.normal(size=100)
<span style="color: #a0522d;">y</span> = np.random.normal(size=100)
plt.plot(x, y)
plt.xlabel(<span style="color: #8b2252;">'This is x-axis'</span>)
plt.ylabel(<span style="color: #8b2252;">'This is y-axis'</span>)
plt.title(<span style="color: #8b2252;">'Plot of X vs Y'</span>)

plt.savefig(<span style="color: #8b2252;">'xyPlot.png'</span>)       <span style="color: #b22222;"># </span><span style="color: #b22222;">only to save figure in a file</span>
</pre>
</div>

<p>
<code>numpy</code> function <code>linspace</code> can be used to create a sequence between a start and
an end of a given length.  
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> numpy <span style="color: #a020f0;">as</span> np
<span style="color: #a020f0;">import</span> matplotlib.pyplot <span style="color: #a020f0;">as</span> plt

<span style="color: #a0522d;">x</span> = np.linspace(-np.pi, np.pi, num=50)
<span style="color: #a0522d;">y</span> = x
<span style="color: #a0522d;">xx</span>, <span style="color: #a0522d;">yy</span> = np.meshgrid(x, y)
<span style="color: #a0522d;">zz</span> = np.cos(yy) / (1 + xx ** 2)

plt.contour(xx, yy, zz)

<span style="color: #a0522d;">fig</span>, <span style="color: #a0522d;">ax</span> = plt.subplots()
<span style="color: #a0522d;">zza</span> = (zz - zz.T) / 2.0
<span style="color: #a0522d;">CS</span> = ax.contour(xx, yy, zza)
ax.clabel(CS, inline=1)
</pre>
</div>
</div>
</div>

<div id="outline-container-org9cc2243" class="outline-4">
<h4 id="org9cc2243"><span class="section-number-4">2.3.3</span> Indexing Data</h4>
<div class="outline-text-4" id="text-2-3-3">
<p>
To access elements of an array, specify indexes inside square brackets.  It is
possible to access multiple rows and columns. <code>shape</code> method gives number of
rows followed by number of columns. 
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> numpy <span style="color: #a020f0;">as</span> np

<span style="color: #a0522d;">A</span> = np.array(np.arange(1, 17))
<span style="color: #a0522d;">A</span> = A.reshape(4, 4, order=<span style="color: #8b2252;">'F'</span>)
<span style="color: #a020f0;">print</span>(A)
<span style="color: #a020f0;">print</span>(A[1, 2])
<span style="color: #a020f0;">print</span>(A[(0, 2), (1, 3)])         <span style="color: #b22222;"># </span><span style="color: #b22222;">does not work</span>
<span style="color: #a020f0;">print</span>(A[<span style="color: #483d8b;">range</span>(0, 3), <span style="color: #483d8b;">range</span>(1, 4)])  <span style="color: #b22222;"># </span><span style="color: #b22222;">does not work</span>
<span style="color: #a020f0;">print</span>(A[<span style="color: #483d8b;">range</span>(0, 2), :])
<span style="color: #a020f0;">print</span>(A[:, <span style="color: #483d8b;">range</span>(0, 2)])
<span style="color: #a020f0;">print</span>(A.shape)
</pre>
</div>

<pre class="example">
[[ 1  5  9 13]
 [ 2  6 10 14]
 [ 3  7 11 15]
 [ 4  8 12 16]]
10
[ 5 15]
[ 5 10 15]
[[ 1  5  9 13]
 [ 2  6 10 14]]
[[1 5]
 [2 6]
 [3 7]
 [4 8]]
(4, 4)
</pre>
</div>
</div>

<div id="outline-container-org9a3f71c" class="outline-4">
<h4 id="org9a3f71c"><span class="section-number-4">2.3.4</span> Loading Data</h4>
<div class="outline-text-4" id="text-2-3-4">
<p>
<code>pandas</code> library provides <code>read_csv</code> function to read files with data in
rectangular shape.  
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> pandas <span style="color: #a020f0;">as</span> pd
<span style="color: #a0522d;">Auto</span> = pd.read_csv(<span style="color: #8b2252;">'data/Auto.csv'</span>)
<span style="color: #a020f0;">print</span>(Auto.head())
<span style="color: #a020f0;">print</span>(Auto.shape)
<span style="color: #a020f0;">print</span>(Auto.columns)
</pre>
</div>

<pre class="example">
    mpg  cylinders  displacement  ... year  origin                       name
0  18.0          8         307.0  ...   70       1  chevrolet chevelle malibu
1  15.0          8         350.0  ...   70       1          buick skylark 320
2  18.0          8         318.0  ...   70       1         plymouth satellite
3  16.0          8         304.0  ...   70       1              amc rebel sst
4  17.0          8         302.0  ...   70       1                ford torino

[5 rows x 9 columns]
(397, 9)
Index(['mpg', 'cylinders', 'displacement', 'horsepower', 'weight',
       'acceleration', 'year', 'origin', 'name'],
      dtype='object')
</pre>

<p>
To load data from an <code>R</code> library, use <code>get_rdataset</code> function from
<code>statsmodels</code>.  This function seems to work only if the computer is connected to
the internet. 
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">from</span> statsmodels <span style="color: #a020f0;">import</span> datasets
<span style="color: #a0522d;">carseats</span> = datasets.get_rdataset(<span style="color: #8b2252;">'Carseats'</span>, package=<span style="color: #8b2252;">'ISLR'</span>).data
<span style="color: #a020f0;">print</span>(carseats.shape)
<span style="color: #a020f0;">print</span>(carseats.columns)
</pre>
</div>

<pre class="example">
(400, 11)
Index(['Sales', 'CompPrice', 'Income', 'Advertising', 'Population', 'Price',
       'ShelveLoc', 'Age', 'Education', 'Urban', 'US'],
      dtype='object')

</pre>
</div>
</div>

<div id="outline-container-org67608e2" class="outline-4">
<h4 id="org67608e2"><span class="section-number-4">2.3.5</span> Additional Graphical and Numerical Summaries</h4>
<div class="outline-text-4" id="text-2-3-5">
<p>
<code>plot</code> method can be directly applied to a <code>pandas</code> dataframe.  
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> pandas <span style="color: #a020f0;">as</span> pd
<span style="color: #a0522d;">Auto</span> = pd.read_csv(<span style="color: #8b2252;">'data/Auto.csv'</span>)
Auto.boxplot(column=<span style="color: #8b2252;">'mpg'</span>, by=<span style="color: #8b2252;">'cylinders'</span>, grid=<span style="color: #008b8b;">False</span>)
</pre>
</div>

<p>
<code>hist</code> method can be applied to plot a histogram. 
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> pandas <span style="color: #a020f0;">as</span> pd
<span style="color: #a0522d;">Auto</span> = pd.read_csv(<span style="color: #8b2252;">'data/Auto.csv'</span>)
Auto.hist(column=<span style="color: #8b2252;">'mpg'</span>)
Auto.hist(column=<span style="color: #8b2252;">'mpg'</span>, color=<span style="color: #8b2252;">'red'</span>)
Auto.hist(column=<span style="color: #8b2252;">'mpg'</span>, color=<span style="color: #8b2252;">'red'</span>, bins=15)
</pre>
</div>

<p>
For pairs plot, use <code>scatter_matrix</code> method in <code>pandas.plotting</code>.  
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> pandas <span style="color: #a020f0;">as</span> pd
<span style="color: #a020f0;">from</span> pandas <span style="color: #a020f0;">import</span> plotting
<span style="color: #a0522d;">Auto</span> = pd.read_csv(<span style="color: #8b2252;">'data/Auto.csv'</span>)
plotting.scatter_matrix(Auto[[<span style="color: #8b2252;">'mpg'</span>, <span style="color: #8b2252;">'displacement'</span>, <span style="color: #8b2252;">'horsepower'</span>, <span style="color: #8b2252;">'weight'</span>,
                              <span style="color: #8b2252;">'acceleration'</span>]])
</pre>
</div>

<p>
On <code>pandas</code> dataframes, <code>describe</code> method produces a summary of each variable. 
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> pandas <span style="color: #a020f0;">as</span> pd
<span style="color: #a0522d;">Auto</span> = pd.read_csv(<span style="color: #8b2252;">'data/Auto.csv'</span>)
<span style="color: #a020f0;">print</span>(Auto.describe())
</pre>
</div>

<pre class="example">
              mpg   cylinders  ...        year      origin
count  397.000000  397.000000  ...  397.000000  397.000000
mean    23.515869    5.458438  ...   75.994962    1.574307
std      7.825804    1.701577  ...    3.690005    0.802549
min      9.000000    3.000000  ...   70.000000    1.000000
25%     17.500000    4.000000  ...   73.000000    1.000000
50%     23.000000    4.000000  ...   76.000000    1.000000
75%     29.000000    8.000000  ...   79.000000    2.000000
max     46.600000    8.000000  ...   82.000000    3.000000

[8 rows x 7 columns]
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org47b72b3" class="outline-2">
<h2 id="org47b72b3"><span class="section-number-2">3</span> Linear Regression</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-orgd189fed" class="outline-3">
<h3 id="orgd189fed"><span class="section-number-3">3.1</span> Simple Linear Regression</h3>
<div class="outline-text-3" id="text-3-1">
<p>
Figure <a href="#orgf55fb6f">17</a> displays the simple linear regression fit to the
<code>Advertising</code> data, where \(\hat{\beta_0} =\) 0.0475
 and \(\hat{\beta_1} =\) 7.0326.
</p>


<div id="orgf55fb6f" class="figure">
<p><img src="figures/fig3_1.png" alt="fig3_1.png" />
</p>
<p><span class="figure-number">Figure 17: </span>For the <code>Advertising</code> data, the least squares fit for the regression of <code>sales</code> onto <code>TV</code> is shown.  The fit is found by minimizing the sum of squared errors.  Each grey line represents an error, and the fit makes a compromise by averaging their squares.  In this case a linear fit captures the essence of the relationship, although it is somewhat deficient in the left of the plot.</p>
</div>




<p>
In figure <a href="#org8ec7f00">18</a>, we have computed RSS for a number of values of
\(\beta_0\) and \(\beta_1\), using the advertising data with <code>sales</code> as the response
and <code>TV</code> as the predictor. 
</p>


<div id="org8ec7f00" class="figure">
<p><img src="figures/fig3_2.png" alt="fig3_2.png" />
</p>
<p><span class="figure-number">Figure 18: </span>Contour and three-dimensional plots of the RSS on the <code>Advertising</code> data, using <code>sales</code> as the response and <code>TV</code> as the predictor.  The red dots correspond to the least squares estimates \(\hat{\beta_0}\) and \(\hat{\beta_1}\).</p>
</div>


<p>
The left-hand panel of figure <a href="#org2f3c3fb">19</a> displays <i>population regression
line</i> and <i>least squares line</i> for a simple simulated example.  The red line in
the left-hand panel displays the <i>true</i> relationship, \(f(X) = 2 + 3X\), while the
blue line is the least squares estimate based on observed data.  In the
right-hand panel of figure <a href="#org2f3c3fb">19</a> we have generated five different
data sets from the model \(Y = 2 + 3X + \epsilon\) and plotted the corresponding
five least squares lines.  
</p>


<div id="org2f3c3fb" class="figure">
<p><img src="figures/fig3_3.png" alt="fig3_3.png" />
</p>
<p><span class="figure-number">Figure 19: </span>A simulated data set.  Left: The red line represents the true relationship, \(f(X) = 2 + 3X\), which is known as the population regression line.  The blue line is the least squares line; it is the least squares estimate for \(f(X)\) based on the observed data, shown in grey circles.  Right: The population regression line is again shown in red, and the least squares line in blue.  In cyan, five least squares lines are shown, each computed on the basis of a separate random set of observations.  Each least squares line is different, but on average, the least squares lines are quite close to the population regression line.</p>
</div>

<p>
For <code>Advertising</code> data, table <a href="#org04276d9">1</a> provides details of the least squares model for the
regression of number of units sold on TV advertising budget. 
</p>

<table id="org04276d9" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 1:</span> For <code>Advertising</code> data, the coefficients of the least squares model</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-right">Coef.</th>
<th scope="col" class="org-right">Std.Err.</th>
<th scope="col" class="org-right">\(t\)</th>
<th scope="col" class="org-right">\(P > \mid t \mid\)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Intercept</td>
<td class="org-right">7.0326</td>
<td class="org-right">0.4578</td>
<td class="org-right">15.3603</td>
<td class="org-right">0.0</td>
</tr>

<tr>
<td class="org-left">TV</td>
<td class="org-right">0.0475</td>
<td class="org-right">0.0027</td>
<td class="org-right">17.6676</td>
<td class="org-right">0.0</td>
</tr>
</tbody>
</table>


<p>
Next, in table <a href="#orgbb208f6">2</a>, we report more information about the least squares model.  
</p>


<table id="orgbb208f6" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 2:</span> For the <code>Advertising</code> data, more information about the least squares model for the regression of number of units sold on TV advertising budget.</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Quantity</th>
<th scope="col" class="org-right">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Residual standard error</td>
<td class="org-right">3.259</td>
</tr>

<tr>
<td class="org-left">\(R^2\)</td>
<td class="org-right">0.612</td>
</tr>

<tr>
<td class="org-left">F-statistic</td>
<td class="org-right">312.145</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org388f5f8" class="outline-3">
<h3 id="org388f5f8"><span class="section-number-3">3.2</span> Multiple Linear Regression</h3>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Naresh Gurbuxani</p>
<p class="date">Created: 2019-05-19 Sun 15:26</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
