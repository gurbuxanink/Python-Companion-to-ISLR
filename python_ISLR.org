#+TITLE: Python Companion to ISLR

* Introduction

Using an =R= code block, we will save =Wage= data as a csv file.

#+BEGIN_SRC R :exports none :results none
  data(Wage, package = 'ISLR')
  write.csv(Wage, file = 'data/Wage.csv')
#+END_SRC

Now we can read =Wage= data in =python= and plot graphs. Figure [[introFig1]] shows
graphs of Wage versus three variables. 

#+NAME: introFig1
#+BEGIN_SRC python :exports none :results file :var fname="figures/fig1_1.png"
  import matplotlib
  matplotlib.use('Agg')
  import pandas as pd
  import numpy as np
  import matplotlib.pyplot as plt

  wages = pd.read_csv('data/Wage.csv', index_col=0)
  ed_level = wages[['education']].applymap(lambda x: x[:1])
  ed_level.rename(index=str, columns={'education': 'ed_level'}, inplace=True)
  ed_level.index = np.vectorize(int)(ed_level.index)
  wages = wages.merge(ed_level, left_index=True, right_index=True)

  fig = plt.figure()
  ax1 = fig.add_subplot(131)
  wages.plot(x='age', y='wage', kind='scatter', ax=ax1, alpha=0.5)
  ax1.set_xlabel('Age')
  ax1.set_ylabel('Wage')

  ax2 = fig.add_subplot(132)
  wages.plot(x='year', y='wage', kind='scatter', ax=ax2, alpha=0.5)
  ax2.set_xlabel('Year')
  ax2.set_ylabel('')

  ax3 = fig.add_subplot(133)
  wages.boxplot(column='wage', by='ed_level', ax=ax3, grid=False)
  ax3.set_title('')
  ax3.set_xlabel('Education level')

  fig.suptitle('')
  fig.tight_layout()
  plt.savefig(fname)
  return fname
#+END_SRC

#+CAPTION: =Wage= data, which contains income survey information for males from the central Atlantic region of the United States.  Left: =wage= as a function of =age=.  On average, =wage= increases with =age= until about 60 years of age, at which point it begins to decline.  Center: =wage= as a function of =year=.  There is a slow but steady increase of approximately \$10,000 in the average =wage= between 2003 and 2009.  Right: Boxplots displaying =wage= as a function of =education=, with 1 indicating the lowest level (no highschool diploma) and 5 the highest level (an advanced graduate degree).  On average, =wage= increases with the level of =education=.
#+NAME: introFig1
#+LABEL: introFig1
#+RESULTS:
[[file:figures/fig1_1.png]]


